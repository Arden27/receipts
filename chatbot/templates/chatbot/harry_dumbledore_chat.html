<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harry and Dumbledore Chat</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        window.onload = function() {
    let conversationStarted = false;

    document.getElementById("continue-conversation").onclick = function () {
        let url = "/harry-dumbledore-chat/";

        if (!conversationStarted) {
            url += "?start_conversation=true";
            conversationStarted = true;
        } else {
            url += "?continue_conversation=true";
        }

        fetch(url)
            .then((response) => response.json())
            .then((data) => {
                if (data.error) {
                    console.error(data.error);
                    alert("Error: " + data.error);
                } else {
                    let chatWindow = document.getElementById("chat-window");
                    let role = data.role;
                    let message = data.response;

                    chatWindow.innerHTML += "<strong>" + role + ":</strong> " + message + "<br/>";
                    chatWindow.scrollTop = chatWindow.scrollHeight;
                }
            });

    };
};

      </script>
      
</head>
<body>
    <h1>Harry and Dumbledore Chat</h1>
    <div id="chat-window" style="border: 1px solid black; padding: 10px; max-width: 800px; margin-bottom: 20px;">
    </div>    
    <button id="continue-conversation">Continue Conversation</button>
</body>
</html>
